
# my global config
global:
  scrape_interval: {{ prometheus_scrape_interval | default('15s') }}
  evaluation_interval: {{ prometheus_evaluation_interval | default('15s') }}
  # scrape_timeout defaults to 10s



# Scrape configurations
scrape_configs:
  - job_name: "prometheus"

    static_configs:
      - targets:
          - "{{ prometheus_target | default('localhost:9090') }}"
        labels:
          app: "prometheus"

  - job_name: "node_exporter"

    static_configs:
      - targets:
{% for host in groups['role_app_server'] %}
        - "{{ hostvars[host]['ansible_host'] }}:9100"
{% endfor %}
        labels:
          app: "node_exporter"